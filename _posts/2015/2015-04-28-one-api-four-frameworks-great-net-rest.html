---
layout: post
title: 'One API, Four Frameworks: The Great .NET ReST Showdown'
date: '2015-04-28T00:26:00.001+01:00'
author: Dylan Beattie
tags:
- rest
- architecture
- restival
modified_time: '2015-04-28T00:28:03.427+01:00'
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-5633857352467348361
blogger_orig_url: http://www.dylanbeattie.net/2015/04/one-api-four-frameworks-great-net-rest.html
redirect_from: "/2015/04/one-api-four-frameworks-great-net-rest.html"

---

<p>There’s only two hard problems in software: cache invalidation, naming things, off-by-one errors, null-terminated lists, and <a href="http://en.wikipedia.org/wiki/Overchoice">choice overload</a>. Back when I started building data-driven websites, classic ASP gave you Request, Response, Application, Session and Server, and you built the rest yourself - <em>and </em>it was uphill both ways! These days, we’re spoiled for choice. Whatever you’re trying to achieve, you can bet good money that somebody’s been there before you. If you’re lucky, they’ve shared some of their code – and if you’re really lucky, they’ve built a framework or a library you can use. </p>  <p>Since the heady days of classic ASP, I’ve built quite a few systems that have to expose data or services to other systems – from standalone HTTP endpoints that just return true or false, to full-featured ReST APIs. I’ve come across several frameworks that are designed to help developers create ReSTful APIs using Microsoft .NET, each of which doubtless has its own strengths and weaknesses – and now I find myself facing the aforementioned choice overload, because if I was starting a new API project right now, I honestly don’t know which framework I’d use. Whilst I’ve got hands-on experience with most of them, I’ve never had the opportunity to try implementing the <em>same API spec </em>in multiple frameworks to compare and contrast their capabilities on a like-for-like basis.</p>  <p>So here goes. Over the next few months, I’m going to be developing the same API in four different frameworks, side-by-side. The APIs have to use the same back-end code – same data access, same business logic – and have to pass the same integration test suite. I’m going to start out really simple = “hello, world!” simple – and gradually introduce features like resource expansion, pagination, OAuth2, content negotiation. The idea is that some of these features will actually break the interface, so I’ll also be looking at how to handle API versioning in each of my chosen frameworks. I’m also going to try and respect the idioms and conventions of each of the frameworks I’m working with – good frameworks tend to be opinionated, and if you don’t agree with their opinions you’re probably not going to find them particularly helpful.&#160; </p>  <h3>The Frameworks</h3>  <h4>Microsoft ASP.NET WebAPI (<a title="http://www.asp.net/web-api" href="http://www.asp.net/web-api">http://www.asp.net/web-api</a>)</h4>  <p>Microsoft’s out-of-the-box solution for building HTTP-driven APIs. Superficially similar to ASP.NET MVC but I suspect there’s much more to it than that. I’ve built a couple of small standalone APIs in WebAPI but not used it for anything too substantial.</p>  <h4>ServiceStack (<a title="https://servicestack.net/" href="https://servicestack.net/">https://servicestack.net/</a>)</h4>  <p>For a long while I was completely smitten with ServiceStack. Then it hit v4.0 and went from free-as-in-beer to expensive-as-in-$999-per-developer for any reasonable-sized project – there is a free usage tier, but it’s pretty restrictive. That said, it’s still a really powerful, flexible framework. Version 3 is still on NuGet, is still available under a BSD license, and there’s at least <a href="http://www.nservicekit.com/">one active project</a> based on a fork of the ServiceStack v3 codebase.&#160; I like ServiceStack’s conventions and idioms; working with it taught me a <em>lot </em>about ReST; it has great support for things like SwaggerUI, and I suspect as I start implementing various API features ServiceStack is going to deliver additional value and capabilities which the other frameworks can’t match. Will it add enough value to justify $999 per developer? We’ll see :)</p>  <h4>OpenRasta (<a title="http://openrasta.org/" href="http://openrasta.org/">http://openrasta.org/</a>)</h4>  <p>I’ve played with OpenRasta on-and-off over the years, though I’ve never used it on anything substantial, but I know the folks over at Huddle are using it in a big way and having great results with it, so I’m really curious to see how it stacks up against the others. (I should probably disclose a slight bias here in that <a href="https://twitter.com/serialseb">Sebastien Lambla</a>, the creator of OpenRasta, is a friend of mine; it was Seb who first got me thinking about ReST via London .NET User Group and prolonged conversations in the pub afterwards.)</p>  <h4>NancyFX (<a title="http://nancyfx.org/" href="http://nancyfx.org/">http://nancyfx.org/</a>)</h4>  <p>This one is completely new to me – until last week, I’d never even looked at it. But so far, it looks really nice – minimalist, elegant and expressive, and I’m looking forward to seeing what it can do.</p>  <h4>Other Candidates</h4>  <p>It would be interesting to get some F# into the mix – mainly because I’ve never used F# and I’m curious. I’ve heard interesting things about <a href="http://websharper.com/">WebSharper</a> and <a href="https://github.com/freya-fs/freya">Freya</a> – and, of course, if anyone wants to add an F# implementation and send me a pull request, go for it!</p>  <h3></h3>  <h3>The API</h3>  <p>I’m using Apiary.IO to design the API itself – you can check it out at <a title="http://docs.restival.apiary.io/" href="http://docs.restival.apiary.io/">http://docs.restival.apiary.io/</a></p>  <h3>The Code</h3>  <p>The code is on GitHub - <a title="https://github.com/dylanbeattie/Restival" href="https://github.com/dylanbeattie/Restival">https://github.com/dylanbeattie/Restival</a>. </p>  <p>If you want to run it, you’ll need to set up IIS applications for each of the four framework implementations – I use a hosts file hack to point restival.local at 127.0.0.1, and I’ve set up <a href="http://restival.local/api.webapi">http://restival.local/api.webapi</a>, <a href="http://restival.local/api.nancy">http://restival.local/api.nancy</a>, <a href="http://restival.local/api.servicestack">http://restival.local/api.servicestack</a> and <a href="http://restival.local/api.openrasta">http://restival.local/api.openrasta</a></p>  <p>The test suite is NUnit, uses RestSharp to make real live HTTP requests, and all the actual test logic is in the abstract base class. There’s four concrete implementations, and the only difference is the URL of the API endpoint under test.</p>  <h3>The Backlog</h3>  <p>Features I want to implement include, but are probably not restricted to…</p>  <ul>   <li>Pagination. What’s a good way to handle huge result sets without causing timeouts and performance problems?</li>    <li>Resource expansion. How do you request a customer, and all their orders, and the invoices linked to those orders, in a single API call?</li>    <li>API versioning – using <a href="http://www.troyhunt.com/2014/02/your-api-versioning-is-wrong-which-is.html">all three different ways of doing it wrong</a></li>    <ul>     <li>Version numbers in the URL (api.foo.com/v1/)</li>      <li>Version numbers in a custom HTTP header (X-Restival-Version: 1.0)</li>      <li>Content negotation based on MIME types (Accept: application/vnd.restival.v1.0+json)</li>   </ul>    <li>OAuth2 and bearer token authentication. (You’ll like this one because I’m not using DotNetOpenAuth)</li>    <li>API documentation – probably by seeing how easily I can add <a href="http://swagger.io/">Swagger</a> support to each implementation</li> </ul>  <p>In every case, this is stuff I’ve already implemented in at least one project over the last couple of years, so it’s going to be interesting seeing how readily those implementations translate across to the other frameworks I’m using. </p>  <p>Sound like fun? You bet it does. Tune in and see how it unfolds. Or come to <a href="http://www.ndcoslo.com/">NDC Oslo in June</a> or <a href="https://skillsmatter.com/conferences/6859-progressive-dotnet-2015">Progressive.NET in London in July</a>, where you not only get to listen to me talk about ReST, you get several days of talks and workshops from some of the best speakers in the industry. </p>  