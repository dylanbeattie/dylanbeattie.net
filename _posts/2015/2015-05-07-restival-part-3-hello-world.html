---
layout: post
title: 'Restival Part 3: Hello, World!'
date: '2015-05-07T22:50:00.001+01:00'
author: Dylan Beattie
tags:
- rest
- architecture
- restival
modified_time: '2015-05-07T22:55:32.566+01:00'
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-2211491910536169800
blogger_orig_url: http://www.dylanbeattie.net/2015/05/restival-part-3-hello-world.html
redirect_from: "/2015/05/restival-part-3-hello-world.html"

---

<p>So far, we've got a <a href="https://github.com/dylanbeattie/Restival/tree/v0.0.1">/hello service up and running in four different frameworks</a> (five if you include <a href="https://github.com/kolektiv/Restival">Andrew 'kolektiv' Cherry's F#/Freya implementation</a>, which looks really interesting). <a href="http://dylanbeattie.blogspot.co.uk/2015/05/restival-part-2-all-aboard-routemaster.html">Last time</a>, we looked at how our frameworks handle routing; in this instalment, we're going to look at adding default values to our route parameters. Specifically, if you just call /hello, the service should return &quot;Hello, World!&quot;</p>  <blockquote>   <p><strong>GET /hello</strong></p>    <p>should return</p>    <p><strong>200 OK</strong></p>    <p><strong>{ &quot;Message&quot; : &quot;Hello, World!&quot; }</strong></p> </blockquote>  <p>OK, so how we do this? There's three places we can potentially do it - the routing, the handlers, or the underlying Greeting object itself - but not all our frameworks support all three options. </p>  <p>Only WebAPI supports explicit defaults in the routing configuration, using this syntax:</p>  <blockquote>   <p><font face="Consolas">config.Routes.MapHttpRoute(       <br />&#160;&#160;&#160; &quot;Hello&quot;, // route name        <br />&#160;&#160;&#160; &quot;hello/{name}&quot;, // route template        <br />&#160;&#160;&#160; new { Controller = &quot;Hello&quot;, <font style="background-color: #ffff00">Name = &quot;World&quot;</font> } // defaults        <br />);</font></p> </blockquote>  <p>ServiceStack doesn't support routing defaults <em>per se</em>, but because the request is decoupled from the rest of our implementation, we can specify the default inside our request DTO - and thanks to the single responsibility principle, we know this isn't going to affect any other details of our implementation</p>  <blockquote>   <p><font face="Consolas">[Route(&quot;/hello&quot;)]       <br />[Route(&quot;/hello/{name}&quot;)]        <br />public class Hello {        <br /><font style="background-color: #ffff00">&#160;&#160;&#160; private string name = &quot;World&quot;;</font>        <br />&#160;&#160;&#160; public string Name {        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; get { return name; }        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; set { name = value; }        <br />&#160;&#160;&#160; }        <br />}</font></p> </blockquote>  <p>OpenRasta's routing maps our requests directly onto the Get method of our HelloHandler, which makes it really easy to use .NET's optional parameter syntax to supply a default value to the handler method itself:</p>  <blockquote>   <p><font face="Consolas">public class HelloHandler {       <br />&#160;&#160;&#160; public object Get(string name<font style="background-color: #ffff00"> = &quot;World&quot;</font>) {        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; return (new Greeting(name));        <br />&#160;&#160;&#160; }        <br />}</font></p> </blockquote>  <p>Finally, NancyFX has such sparse routing that there's only really one line of code we <em>could </em>modify - after all, our entire API's only two lines of code, and the other one's doing our /hello/{name} implementation.</p>  <blockquote>   <p><font face="Consolas">public class HelloModule : NancyModule {       <br />&#160;&#160;&#160; public HelloModule() {        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Get[&quot;/hello&quot;] = _ =&gt; new Greeting(<font style="background-color: #ffff00">&quot;World&quot;</font>);        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Get[&quot;/hello/{name}&quot;] = parameters =&gt; new Greeting(parameters.name);        <br />&#160;&#160;&#160; }        <br />}</font></p> </blockquote>  <p>Astute readers will be going &quot;but hang on - you've just defined the same default in four different places! That's not very SOLID! What if it changes?&quot; - and yes, you're exactly right. Because this is a demo application, I'm favouring readability over abstraction; if you had to define this kind of default behaviour in four different places in a real app, you'd do it using constants, or implement it on the Greeting object itself so the code is reused between all four endpoints.</p>  <p>Code for this post is on <a href="https://github.com/dylanbeattie/Restival/releases/tag/v0.0.2">GitHub as v0.0.2</a>. </p>  <p>Now we've got a basic skeleton API up and running, it's probably time to share my to-do list - things we'll be implementing, in no particular order</p>  <ul>   <li>List resources, and retrieving multiple objects</li>    <li>Support for PUT and DELETE (easy), POST (interesting) and PATCH (<em>really</em> interesting)</li>    <li>Hypermedia links using <a href="http://stateless.co/hal_specification.html">HAL</a></li>    <li>Pagination and resource expansion, as described in <a href="https://stormpath.com/blog/linking-and-resource-expansion-rest-api-tips/">this excellent post on the Stormpath blog</a> and <a href="http://venkat.io/posts/expanding-your-rest-api/">this blog post from Etsy's Venkata Mahalingam</a></li>    <li>API versioning - because, sooner or later, we're going to break something and need to maintain backward compatibility for older clients. Check out <a href="http://www.troyhunt.com/2014/02/your-api-versioning-is-wrong-which-is.html">Troy Hunt's great post on API versioning</a> for a preview of how we'll be getting this wrong in three different ways.</li>    <li>OAuth2 and bearer authentication - this one's going to take some work, because before you can build an OAuth2 API, you need an OAuth2 authentication server, but I've wanted to build a really lightweight .NET OAuth2 server for a while so I'm quite looking forward to it.</li>    <li>API documentation using tools like <a href="http://swagger.io/">Swagger</a>, which generates documentation based on metadata exposed by your API itself. </li> </ul>  <p>See you next time.</p>  