---
layout: post
title: A Better Example of Command-Query Separation
date: '2009-09-17T16:23:00.001+01:00'
author: Dylan Beattie
tags:
- dotnet
- c#
modified_time: '2017-03-18T15:03:45.232Z'
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-8396996347841575137
blogger_orig_url: http://www.dylanbeattie.net/2009/09/better-example-of-command-query.html
---

<p><a href="http://twitter.com/Daneel3001">Daneel3001</a> just <a href="http://twitter.com/Daneel3001/status/4055024776">posted</a> this little quartet on Twitter:</p>  <blockquote>   <p>@udidahan decisions. And I guess the command will either succeed, or fail by raising a compensating action (booking couldn't succeed).</p>    <p>@udidahan Yet, there are some cases where the command will not enable the domain, cinema room here, won't have the freedom to make much.</p>    <p>@udidahan You were rightly stating that grid like views of data as having negative effect on understanding intent of user actions.</p>    <p>@udidahan Maybe instead of using the hotel booking analogy for explaining CQS you could have used the cinema seat booking. </p> </blockquote>  <p>- and that reminded me of one of my all-time frustrations with the internet – booking theatre tickets – which, coincidentally, dovetails very neatly with something Udi Dahan was describing last night.</p>  <p>I work in Leicester Square. I walk past a dozen theatres every day, so if I want to see a show, it really doesn’t matter <em>when</em> I go and see it. I can go any time – and yet, every single theatre and ticket website starts the search process by saying “which day do you want to go?” – and then this happens:</p>  <p><strong>Me</strong>: Friday.     <br /><strong>Computer</strong>: Sorry, sold out.     <br /><strong>Me</strong>: OK, Wednesday.     <br /><strong>Computer</strong>: Sorry, sold out.     <br /><strong>Me: </strong>OK, Tuesday.     <br /><strong>Computer</strong>: Great! Tuesday! We can do that! Now, choose a seating section:     <br /><strong>Me</strong>: Dress Circle, please.     <br /><strong>Computer</strong>: Sorry – sold out.</p>  <p>What I <em>really</em> want is a to be able to say “I want to see Mamma Mia. I want to sit anywhere in the front ten rows, anytime between now and Christmas, and I can’t make Sep 23rd or any Saturday” – and, as Udi put it, <em>let the computer do the busy-work</em>. I <strong>know</strong> that the data is in there. I <strong>know</strong> that there are algorithms capable of fulfilling that request. Why the hell am I sitting here brute-forcing a solution and whacking the back button like I’m playing Track &amp; Field 2 all over again?</p>  <p>Most current ticket-booking websites will reduce your request to “seats H24, H25, H26 and H27 for Chicago at 19:00 on Saturday 25th” – but that request is just too detailed, and far too prone to failure, and doesn’t reflect AT ALL what I’m actually trying to achieve. Maybe I’m only in town for Saturday night and don’t care what show I see. Maybe I desperately want to see Chicago but I’m prepared to go on any night. Maybe I’d be happy with two pairs of tickets instead of four together. I’d love a website that actually asked me what I wanted <strong>on my terms</strong> instead of presenting me with a bunch of data and expecting me to do the grunt work.</p>  <p>Command-query separation would appear to be the first step towards this – but it seems that what’s <em>really</em> important here is that your command model reflects the <strong>intention of your users</strong>, rather than the shape of your data. </p>  