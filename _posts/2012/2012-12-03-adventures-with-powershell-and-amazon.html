---
layout: post
title: Adventures with Powershell and Amazon EC2 (part 1)
date: '2012-12-03T13:18:00.001Z'
author: Dylan Beattie
tags: 
modified_time: '2012-12-03T13:18:15.629Z'
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-6763249131118493823
blogger_orig_url: http://www.dylanbeattie.net/2012/12/adventures-with-powershell-and-amazon.html
redirect_from: "/2012/12/adventures-with-powershell-and-amazon.html"

---

<p>Managing servers isn’t fun. Setting up servers isn’t fun. I don’t want to do it any more, ever – it’s tedious, repetitive and error-prone, and, dammit, we have <em>machines</em> to do those kinds of jobs these days. </p>  <p>So, here’s what I’m trying to do. I want to be able to spin up a blank Windows instance on Amazon EC2 and deploy our apps onto it without ever logging into the box directly. This means no remote desktop sessions, no VNC, no SSH – nothing. These blog posts are as much a diary of work in progress as anything else… I’ll probably make mistakes and get things wrong along the way, but hopefully I’ll end up with something usable.</p>  <h3>Step 1: Hello, World!</h3>  <p>Prerequisites:</p>  <ol>   <li>An Amazon EC2 security group with firewall rules accepting all connections from your local network.</li>    <li>A fresh Windows instance running in that security group, bound to an Amazon elastic IP</li>    <li>The Windows Administrator username and password for that instance.</li> </ol>  <p>Create this script on your local workstation:</p>  <blockquote>   <p><font size="2" face="Consolas">$remoteUsername = &quot;Administrator&quot;       <br />$remotePassword = &quot;<font color="#a5a5a5"><em>your Amazon EC2 instance Administrator password</em></font>&quot;        <br />$remoteHostname = &quot;<em><font color="#a5a5a5">the elastic IP bound to your Amazon EC2 box</font></em>&quot;</font></p>    <p><font size="2" face="Consolas">$securePassword = ConvertTo-SecureString -AsPlainText -Force $remotePassword       <br />$cred = New-Object System.Management.Automation.PSCredential $remoteUsername, $securePassword</font></p>    <p><font size="2" face="Consolas">Invoke-Command -ComputerName $remoteHostname -Credential $cred -ScriptBlock {       <br />&#160;&#160;&#160; Write-Host &quot;Hello, World (from $env:COMPUTERNAME)&quot;</font>      <br />}</p> </blockquote>  <p>Run it. You should get:</p>  <p><font face="Consolas">Invoking command on Remote host <font color="#a5a5a5"><em>X.X.X.X         <br /></em></font>Hello, World (from AMAZONA-???????)</font></p>  <p>If that works, you’ve got Powershell remoting working against your Amazon EC2 instance. Hurrah!</p>  