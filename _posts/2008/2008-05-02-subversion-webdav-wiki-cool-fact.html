---
layout: post
title: Subversion + WebDAV + Wiki = Cool. Fact.
date: '2008-05-02T19:17:00.001+01:00'
author: Dylan Beattie
tags:
- wiki
- altnet
- confluence
- subversion
modified_time: '2008-05-06T11:08:48.305+01:00'
thumbnail: http://lh5.ggpht.com/dmb197/SBtavPvt-SI/AAAAAAAAACc/dTb1nxz65Rs/s72-c/IMG_4217_thumb%5B2%5D.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-2401863321551930036
blogger_orig_url: http://www.dylanbeattie.net/2008/05/subversion-webdav-wiki-cool-fact.html
---

<p>Following on from <a href="http://dylanbeattie.blogspot.com/2008/05/getting-started-with-confluence.html">yesterday's post about Confluence</a>, I've been thinking how to get the same sort of workflow going for images, screenshots and designs - basically, stuff that isn't text.</p>  <p>A lot of our projects start life as Visio diagrams. A couple of us use Visio to actually put them together; everyone else has the free Visio viewer plug-in for Internet Explorer which means they can browse and view our work but can't edit it. Which is probably a good thing. Likewise, most of our designs start life as PSDs, and we always seem to end up with a couple of random spreadsheets full of data that isn't clean enough to import into the actual project DB yet but which is too important to ignore.</p>  <p><a href="http://lh3.ggpht.com/dmb197/SBtauvvt-RI/AAAAAAAAACU/9bLXXG_mujk/s1600-h/IMG_4217%5B4%5D.jpg"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="184" alt="Erzs&#233;bet Bridge, Budapest. " src="http://lh5.ggpht.com/dmb197/SBtavPvt-SI/AAAAAAAAACc/dTb1nxz65Rs/IMG_4217_thumb%5B2%5D.jpg?imgmax=800" width="244" align="right" border="0" /></a>There's this principle in software engineering - Don't Repeat Yourself (DRY) - which basically means if you do something, do it exactly once, so that if it changes you only need to modify one piece of code. I think it's one of the absolute core principles of writing maintainable software, but I also believe the same principle is equally applicable to documentation, configuration - in fact, <strong>anything</strong> that involves manual intervention when changes are required. If I create a class diagram, I want to maintain a <strong>single master copy</strong> of that class diagram and, in a perfect world, any documents or pages that refer to it should be smart enough to always refer to that master copy. </p>  <p>We use <a href="http://subversion.tigris.org/">Subversion</a> as our version control system, but the principle of update-merge-edit-commit applies pretty well to almost any resource in a collaborative development process - there's even folks out there who keep their <a href="http://www.onlamp.com/pub/a/onlamp/2005/01/06/svn_homedir.html">entire life in Subversion</a>. So...&#160; assuming we're keeping all our diagrams, designs and documents in Subversion, how can I link a page in our wiki directly to the latest revision of a document inside the repository?</p>  <p>Turns out it's pretty straightforward, mainly because other people have already built all the hard bits. </p>  <p>The key to all this is an Apache module, mod_dav_svn, that's part of Subversion and exposes your Subversion repository via WebDAV.&#160; Since WebDAV is an extension of HTTP/1.1, that means you can use pretty much any web browser to navigate and view documents in the repository.</p>  <p>We already had Subversion up and running, so to add Apache and the WebDAV module I just followed the <a href="http://svnbook.red-bean.com/en/1.4/svn.serverconfig.httpd.html">Apache install instructions in the Subversion book</a>. </p>  <p>One thing to note - Subversion on Windows will not work with Apache 2.2.x; the mod_dav_svn module isn't compatible with this version and will give you warning messages about &quot;mod_dav_svn.so is garbled&quot;. You'll need to install the latest version of the 2.0 series (2.0.63 in my case), and you'll also ideally want to disable IIS or any other web server on the box that's hosting your repository so that Apache can use port 80 on the server's primary IP.</p>  <p>Once it's all up and running, next time you're editing a Wiki page and think &quot;hey, I really want to link to the Visio user experience workflow diagram here&quot; - easy. Just point the link at the full URL of that diagram inside your WebDAV repository - something like <u></u></p>  <p><u>http://my.subversion.server/svn/myproject/docs/workflow/User+Experience.vsd</u> </p>  <p>I think the real advantage of this approach is that you're not constantly exporting Visio docs as JPEGs and uploading them to the wiki - that's high-maintenance, and there's never any guarantee that the JPEGs in the wiki actually reflect the latest state of the original diagrams.</p>  <p>With this approach, you just run svn update locally to get the latest set of documents, make your changes, and&#160; run svn commit - just like checking in regular code. Any links pointing to your document via the WebDAV repository will always point to the latest version - and you never have to worry about maintaining multiple copies.</p>  <p>Confluence, the wiki engine we're using right now, should theoretically let you embed images that are hosted under WebDAV - so your tags end up something like </p>  <p><strong>&lt;img src=&quot;</strong><strong>http://my.subversion.server/svn/myproject/docs/homepage01.png&quot;</strong><strong> alt=&quot;Homepage design (01)&quot; /&gt; </strong></p>  <p>as well as just creating hyperlinks to documents - but Confluence doesn't seem to like that right now. </p>  <p>UPDATE: It's possible to work around this bug by inserting the image URL directly into the Wiki markup surrounded by exclamation marks - <code style="color: #000000">!http://www.myserver.com/image.jpg!</code> will display image.jpg from www.myserver.com as a normal IMG tag. Not quite as streamlined as drag'n'drop but it does work.</p>  <p><a href="http://lh3.ggpht.com/dmb197/SBtavvvt-TI/AAAAAAAAACk/CHcxeOFmVWQ/s1600-h/IMG_4307%5B7%5D.jpg"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; margin: 0px 10px 10px 0px; border-right-width: 0px" height="184" alt="Spring blossom in Budapest" src="http://lh5.ggpht.com/dmb197/SBtawPvt-UI/AAAAAAAAACs/nxS-hD25yyM/IMG_4307_thumb%5B5%5D.jpg?imgmax=800" width="244" align="left" border="0" /></a>As an aside - right now we've got a build server running on IIS, a wiki engine running J2EE on Tomcat, and Subversion hosted from Apache, but the resulting environment actually feels more cohesive and integrated than most of the IIS-only setups I've played with over the last year or so. Personally, I think this is because the quality of the apps themselves - Apache, Subversion, Confluence, FinalBuilder, CruiseControl.NET - is so high that the underlying platform is basically irrelevant in day-to-day use. What's been really apparent getting this configuration up and running, though, is that the package authors (or vendors - never quite sure what you call the people you get free stuff from...) have put enough effort into the installers that the platform doesn't really matter at installation time either. Sure, it means we're running three different web servers right now - but they seem to be working, and maybe we should be thinking in terms of eggs &amp; baskets instead.</p>  