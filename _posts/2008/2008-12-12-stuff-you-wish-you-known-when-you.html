---
layout: post
title: Stuff You'll Wish You'd Known When You Switched To 64-bit Windows
date: '2008-12-12T11:30:00.001Z'
author: Dylan Beattie
tags:
- howto
- hardware
- tools
- x64
modified_time: '2008-12-12T12:01:33.454Z'
thumbnail: http://lh5.ggpht.com/_LV_l8kYLOwo/SUJQVDEikAI/AAAAAAAAAH4/e3uiG0sI8Gw/s72-c/Dylan_IMG_3203_thumb%5B5%5D.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-9027673522367310993
blogger_orig_url: http://www.dylanbeattie.net/2008/12/stuff-you-wish-you-known-when-you.html
---

<p><a href="http://lh6.ggpht.com/_LV_l8kYLOwo/SUJQU2eMVaI/AAAAAAAAAH0/DAS6FxtULRs/s1600-h/Dylan_IMG_3203%5B7%5D.jpg"><img style="border-right: 0px; border-top: 0px; margin: 0px 0px 10px 10px; border-left: 0px; border-bottom: 0px" height="240" alt="A pagoda at sunset in Kyoto, Japan. This has nothing to do with 64-bit Windows, but it is quite pretty." src="http://lh5.ggpht.com/_LV_l8kYLOwo/SUJQVDEikAI/AAAAAAAAAH4/e3uiG0sI8Gw/Dylan_IMG_3203_thumb%5B5%5D.jpg?imgmax=800" width="180" align="right" border="0" /></a>64-bit Windows is great. I've been running on XP 64 and Vista 64&#160; for about a year now. My extremely old Canon USB scanner isn't supported, and I had to wait a <em>long </em>time for 64-bit drivers for my <a href="http://line6.com/podxt/index.html">Line6 Pod XT</a>, but otherwise everything works very nicely - and for running virtual PCs, the extra memory is really worth it.</p>  <p>That said, there's a couple of underlying differences that result in some very odd behaviour in day-to-day usage. It's important to realize that 32-bit and 64-bit Windows subsystems exist as parallel but separate environments. Confusingly, the 64-bit tools and utilities live in <strong>C:\Windows\System32</strong>, and their 32-bit counterparts live in <strong>C:\Windows\SysWOW64</strong>. 32-bit processes on x64 Windows are actually running inside a virtual environment, which redirects requests for underlying system resources for 32-bit processes. </p>  <p>64-bit Windows ships with 32-bit and 64-bit versions of lots of common applications - including Internet Explorer and the Windows Script Host. Check out the links below for some more detailed discussion of the architecture and reasoning behind this.</p>  <h4>Internet Explorer</h4>  <p>You'll find <strong>Internet Explorer </strong>and <strong>Internet Explorer (64 bit) </strong>in your Start menu. The 64-bit version can't see any 32-bit components - so no Flash player, no Java, no plugins, no ActiveX controls, nothing. This is useful for testing, but not much else.</p>  <h4>Windows Scripting Host</h4>  <p>If you run a Windows script (myscript.vbs) from cmd.exe or directly from Explorer, it'll run as a 64-bit process, which means it can't see any 32-bit COM objects like ADO connections and datasets. If you explicitly invoke it using C:\Windows\SysWOW64\cscript.exe, it'll run as a 32-bit process. </p>  <h4>The Windows\System32 folder</h4>  <p>64-bit apps - like the notepad.exe that ships with Windows - can see C:\Windows\System32\ and it's various subfolders. 32-bit apps - like TextPad - can't see this folder because Windows is &quot;hiding&quot; the system folders from the 32-bit process. This is completely baffling when you try to edit your <strong>/etc/hosts</strong> file using your normal editor and it appears to be completely missing - even though you had it open in Notepad a second ago. There's a thing called the <a href="http://msdn.microsoft.com/en-us/library/aa384187(VS.85).aspx">sysnative file system redirector</a> that you'll need to set up to be able to see these folders from 32-bit apps. </p>  <h4>The Registry</h4>  <p>The same caveat applies to the registry.&#160; When a 32-bit app asks for a value stored under, say, </p>  <p><strong> HKEY_LOCAL_MACHINE\Software\MyCompany\MyProject</strong>, </p>  <p>64-bit Windows will actually return the value from</p>  <p>&#160;<strong>HKEY_LOCAL_MACHINE\Software\Wow6432Node\MyCompany\MyProject</strong>.</p>  <p>This is normally fine, because most 32-bit apps are installed by a 32-bit installer, so the redirection is in place both during install (when the keys are created) and at runtime (when they're used). If you're manually importing registry keys - e.g. by doubleclicking a .reg file - they'll import into the locations specified in the file, and then your 32-bit apps won't be able to find them. You'll need to manually copy the keys and values into the Wow6432Node subtree (or edit the original .reg file and re-import)</p>  <h4>References</h4>  <p><a title="http://blogs.msdn.com/helloworld/archive/2007/12/12/activex-component-can-t-create-object-when-creating-a-32-com-object-in-a-64-bit-machine.aspx" href="http://blogs.msdn.com/helloworld/archive/2007/12/12/activex-component-can-t-create-object-when-creating-a-32-com-object-in-a-64-bit-machine.aspx">http://blogs.msdn.com/helloworld/archive/2007/12/12/activex-component-can-t-create-object-when-creating-a-32-com-object-in-a-64-bit-machine.aspx</a></p>  <p><a title="http://blogs.sepago.de/helge/2008/03/11/windows-x64-all-the-same-yet-very-different-part-5/" href="http://blogs.sepago.de/helge/2008/03/11/windows-x64-all-the-same-yet-very-different-part-5/">http://blogs.sepago.de/helge/2008/03/11/windows-x64-all-the-same-yet-very-different-part-5/</a></p>  