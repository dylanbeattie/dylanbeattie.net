---
layout: post
title: Making Your SVN mod_dav_svn Repository Firefox-Friendly
date: '2008-09-30T21:11:00.000+01:00'
author: Dylan Beattie
tags: 
modified_time: '2008-09-30T21:11:46.360+01:00'
thumbnail: http://lh3.ggpht.com/dmb197/SM7G9KJMc7I/AAAAAAAAAEM/D_FLpLgtRlo/s72-c/image_thumb%5B7%5D.png
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-8683991501884481915
blogger_orig_url: http://www.dylanbeattie.net/2008/08/making-your-svn-moddavsvn-repository.html
redirect_from: "/2008/08/making-your-svn-moddavsvn-repository.html"

---

<p>There's a great add-on module for Subversion - <a href="http://svnbook.red-bean.com/en/1.4/svn.serverconfig.httpd.html">mod_dav_svn</a>, which I've <a href="http://dylanbeattie.blogspot.com/2008/05/subversion-webdav-wiki-cool-fact.html">blogged about before</a> - that exposes the contents of your repository through a Web server interface. This is great for bringing up designs, ideas and HTML prototypes in meetings - we've got one of those interactive whiteboard things, and we've&#160; saved lots of time, and probably a couple of acres of forest, by showing designs on the screen instead of printing handouts.</p>  <p>This doesn't quite work out-of-the-box, though. It'll sort-of work if you're using Internet Explorer to browse your WebDAV repository, but Firefox and Opera will probably display everything as plain text. Or gibberish. This is because Apache is sending a Content-Type header telling the browser that the content is text/plain, and Apache in turn is getting this information directly from Subversion. To get everything displaying properly, you'll need to make sure that every file in your repository has the proper MIME type associated with it in Subversion.</p>  <h3>Using auto-props to set MIME types automatically when adding files to a repository</h3>  <p>This bit depends on your client. Check out the <a href="http://svnbook.red-bean.com/nightly/en/svn.advanced.props.html#svn.advanced.props.auto">official documentation on the auto-props feature</a>; it's also worth knowing that you can open the svn configuration file in Notepad via the handy Edit button in the Tortoise settings dialog - right-click any folder window in Windows Explorer, hit TortoiseSVN -&gt; Settings... </p>  <p><a href="http://lh3.ggpht.com/dmb197/SM7G8dIrGGI/AAAAAAAAAEI/_hWtKqH5jqQ/image%5B11%5D.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="264" alt="image" src="http://lh3.ggpht.com/dmb197/SM7G9KJMc7I/AAAAAAAAAEM/D_FLpLgtRlo/image_thumb%5B7%5D.png" width="400" border="0" /></a>&#160;</p>  <h4>To update files already in the repository</h4>  <p>The auto-props feature is all very well, but if (as I did) you don't find out about it until you've already got a repository full of stuff, you have a second problem - how do you set the MIME-type properties on everything that's already in your repository?</p>  <p>This works on Windows, via the command shell, and needs the command-line version of svn installed - try the <a href="http://www.sliksvn.com/en/download">SlikSVN installer</a> if you don't have svn already installed. Remember that although your repository is probably organised into projects, with their own trunks, tags and branches, it's still just a great big hierarchy of files and folders - if you do an svn checkout from svn://my.subversion.server/ without specifying /myproject/trunk, <strong>you will check out the HEAD version of your entire repository.</strong> (These techniques work just as well on individual trunks, branches and sub-folders, of course.)</p>  <p>First, check out the folder, branch or even the entire repository into a working folder - say c:\repository\. </p>  <p>Then run this:</p>  <p><strong>C:\repository&gt;for /r %1 in (*.gif) do svn propset svn:mime-type image/gif &quot;%~f1&quot;</strong></p>  <p><strong>for</strong> is the Windows shell command that basically says &quot;repeat the following for every file matching this specification&quot; - and we're saying <strong>for /r %1 in (*.gif), </strong>meaning &quot;recursively find every file matching *.gif in or below the current folder, temporarily reference that file as %1, and run the following command&quot; - where the command itself is <strong>svn propset svn:mime-type image/gif &quot;%~f1&quot;</strong></p>  <p>Note that the %1 reference there is quoted, and we're using the <strong>~f</strong> modifier to expand it to the full path - you may find</p>  <p><strong>C:\repository&gt;for /r %1 in (*.gif) do echo &quot;%~f1&quot;</strong></p>  <p>enlightening if this doesn't make sense - remember, everything after the <strong>do</strong> is invoked for each matching file.</p>  <p>So, when <strong>for</strong> matches something.gif under myproject\trunk in your repository, it'll call svn.exe with the command line </p>  <p><strong>svn propset mime-type image/gif &quot;C:\repository\myproject\trunk\something.gif&quot;</strong></p>  <p>- which will set the MIME-type on something.gif to image/gif.</p>  <p>Repeat this incantation using the various file extensions and MIME types you need to configure, e.g.</p>  <p><strong>C:\repository&gt;for /r %1 in (*.jpg) do svn propset svn:mime-type image/jpeg &quot;%~f1&quot;      <br /></strong><strong>C:\repository&gt;for /r %1 in (*.htm*) do svn propset svn:mime-type text/html &quot;%~f1&quot;</strong></p>  <p>and once you're done, commit your changes back to the repository. You'll see a whole lot of SVN &quot;Property changed&quot; messages, and next time you browse your repository via mod_dav_svn, you should find things are working as expected.    </p>  