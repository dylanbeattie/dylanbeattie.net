---
layout: post
title: 'Just Do It: Command-Query Segregation, Nike-Style'
date: '2011-06-29T21:10:00.001+01:00'
author: Dylan Beattie
tags: 
modified_time: '2011-06-29T21:11:27.910+01:00'
thumbnail: http://lh4.ggpht.com/-9aO3mKNTyQc/TguG7qxOalI/AAAAAAAAAGk/EbIYzjQsOwM/s72-c/image_thumb%25255B2%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-7295454224203070190.post-7093045819229526256
blogger_orig_url: http://www.dylanbeattie.net/2011/06/just-do-it-command-query-segregation.html
---

<p>OK, CQRS is a hugely mis-applied and mis-understood architectural style. The insight I'm sharing here is based on my attending Udi Dahan's Advanced Distributed Systems Architecture course, then applying what I'd learned to a project we were building for 3-4 months, then having one of my colleagues go on the same course, and then have him come back and point out everything we'd done wrong. Let's assume you are already using CQRS. Maybe you're using it appropriately; maybe it's over-engineering; maybe it's completely misapplied. Doesn't matter, for what I have to say here; there are smarter folks than I who can tell you whether you should be doing it in the first place. No, I'm here to share a particular insight about CQRS with you.</p>  <p align="center"><strong>Your commands should be like a psychotic drill sergeant screaming orders.</strong></p>  <p align="center"><a href="http://lh5.ggpht.com/-Tc6aCXoOOIc/TguG6I0JozI/AAAAAAAAAGg/U6XZf5RdPYE/s1600-h/image%25255B4%25255D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/-9aO3mKNTyQc/TguG7qxOalI/AAAAAAAAAGk/EbIYzjQsOwM/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="364" /></a></p>  <p>&#160;</p>  <p>When you issue a command, <strong>your work is done. </strong>End of story. Maybe it happens immediately. Maybe there's a delay, and someone has to wait a few seconds. Maybe it doesn't go according to plan, and somebody else notices afterwards, and they call someone else, and it gets fixed up. Maybe it fails spectacularly. You don't care. (Hell, you're probably dead by now. Nobody would ever have won any wars if everyone threw an exception when they found the sarge face-down in a fox-hole with a bullet-hole in his head.)</p>  <p>You're the sarge. You are IN COMMAND. You order someone to destroy the ammo dump in North Camp, then you get on with your life. Tomorrow morning, you'll get a fresh intel report. Maybe it'll say that ammo dump in North Camp has been destroyed - maybe it won't. You'll review the fresh intelligence, decide what to next, issue a fresh batch of orders - and <strong>get on with your life. </strong>That's CQRS. Your data is stale, your word is LAW, and you have better things to do than hang around wondering if you maybe did the wrong thing. If you give a command, and it doesn't get obeyed, there's exactly two potential outcomes:</p>  <ol>   <li>Nobody notices</li>    <li>Somebody notices</li> </ol>  <p><strong>Nobody notices? </strong>Cool. No problem. <strong>Somebody notices? </strong>Well - that's where you hope it's one of your guys (i.e. alerts, logging, infrastructure, monitoring) instead of one of THEIR guys (i.e&#160; customers/clients) That's how you do CQRS. Get your intelligence - your queries. The freshest data you can get, but don't bust a gut if it's a little out of date. Give your orders. Trust your intelligence. Get on with your life. Rinse. Repeat.</p>  